<template name="organization">
  <section class="about"> 
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-lg-offset-2 text-center">
          <h1>Welcome to {{name}}</h1>
          {{> organizationInformation}}
        </div>
      </div>
      <div class="row"> 
        <div class="col-sm-8 col-lg-offset-2">
          <table class="table needs-table">
            <tr>
              <td><h4>Title</h4></td>
              <td><h4>Needed</h4></td>
              <td><h4>Planned</h4></td>
              <td><h4>Progress</h4></td>
            </tr>
            {{#each organizationNeeds name}}
                {{> organizationNeed}}
            {{/each}}
          </table>
          {{#if hasAccess}}
            <div>
              <form class="new-need need-form">
                <input type="text" name="what" placeholder="What do you need?" />
                <input type="text" name="amount" placeholder="How many?">
                <button type="submit" class="btn btn-success">Submit</button>
              </form>
            </div>
          {{/if}}
        </div>
      </div>
    </div>
  </section>
</template>

<template name="organizationInformation" >  
  {{#if hasAccessToOrganization}}
    <p><a id="organizationRedirect" href="{{pathFor route='organizations'}}/{{name}}/edit" class="btn btn-info">Edit my organization</a></p>
  {{/if}}
  {{message}}
</template>

<template name="organizationNeed">
  <tr class="need-row">
    <td>{{title}}</td>
    <td>{{needed}}</td>
    <td>{{planned}}</td>
    <td>
      <div class="progress">
        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{progress}}%">
        </div>
      </div>
    </td>
    <td>
      <button data-toggle="collapse" data-target="#{{_id}}" type="submit" class="btn btn-success">Donate</button>
    </td>
  </tr>
  {{#if hasAccess}}
    {{#each donations}}
        {{> donation}}
    {{/each}}
  {{/if}}
  <tr class="donate-row collapse out" id={{_id}}>
    <td>
      <form class="new-donation">
        <input type="text" name="name" placeholder="Your name">
        <input type="number" name="amount" placeholder="Amount">
        <input type="datetime" name="expectedDelivery" placeholder="When can you deliver?">
        <button type="submit" data-toggle="collapse" data-target="#{{_id}}" class="btn btn-primary">Save</button>
      </form>
    </td>
  </tr>
</template>

<template name="donation">
  <tr class="donation-row">
    <td>{{name}}</td>
    <td>{{amount}}</td>
    <td>{{expectedDelivery}}</td>
  </tr>
</template>